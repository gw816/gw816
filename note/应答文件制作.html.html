<html>
<head>
  <title>应答文件制作.html</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/306387 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="915"/>
<h1>应答文件制作.html</h1>

<div>
<span><h1><a href="http://www.cnblogs.com/dreamer-fish/p/3468388.html">应答文件制作</a></h1><div><p> </p><p><strong><span style="color: #ff0000; font-size: medium;">添加和配置 Windows 设置</span></strong></p><p>       在此步骤中，将定义基本磁盘配置和“欢迎使用 Windows”设置。</p><p>       1、在 Windows SIM 的“Windows 映像”窗格中，展开“组件”节点以显示可用的设置。<br/>
       2、在展开的组件列表中，右键单击组件并选择适当的配置阶段，将下表中的组件添加到答案文件。此操作会在指定配置阶段或 Windows 安装阶段将组件添加到答案文件中。通过添加可选组件，可以在步骤 2（构建参考安装）中更加方便地测试安装。<br/>
       注意：展开 Windows 映像窗格中的组件列表，直到看见下表中的最低层子节点。例如，展开 Microsoft-Windows-Setup 可查看 DiskConfiguration 节点。展开 DiskConfiguration 节点，直到看见 Disk 节点。继续展开 Microsoft-Windows-Setup 下的树，直到看见下表中列出的 CreatePartition 节点。将此 CreatePartition 节点添加到答案文件。此快捷方式可一步将该设置和所有父设置添加到答案文件。 </p><p> </p><table border="1" cellpadding="1" cellspacing="1" style="width: 90%;"><tbody><tr><td> 组件</td><td> 配置阶段</td></tr><tr><td> Microsoft-Windows-Deployment\Reseal</td><td> <strong>oobeSystem</strong></td></tr><tr><td> Microsoft-Windows-International-Core-WinPE\SetupUILanguage</td><td> <strong>windowsPE</strong></td></tr><tr><td> Microsoft-Windows-Setup\DiskConfiguration\Disk\CreatePartitions\CreatePartition</td><td> <strong>windowsPE</strong></td></tr><tr><td> Microsoft-Windows-Setup\DiskConfiguration\Disk\ModifyPartitions\ModifyPartition</td><td> <strong>windowsPE</strong></td></tr><tr><td> Microsoft-Windows-Setup\DiskConfiguration\Disk\CreatePartitions\CreatePartition *</td><td> <strong>windowsPE</strong></td></tr><tr><td> Microsoft-Windows-Setup\DiskConfiguration\Disk\ModifyPartitions\ModifyPartition *</td><td> <strong>windowsPE</strong></td></tr><tr><td> Microsoft-Windows-Setup\ImageInstall\OSImage\InstallTo</td><td> <strong>windowsPE</strong></td></tr><tr><td> Microsoft-Windows-Setup\UserData</td><td> <strong>windowsPE</strong></td></tr><tr><td> Microsoft-Windows-Shell-Setup\OOBE</td><td> <strong>oobeSystem</strong></td></tr><tr><td> <em>可选：</em>Microsoft-Windows-IE-InternetExplorer</td><td> <strong>specialize</strong></td></tr></tbody></table><p> </p><p>       * 此示例使用的是两个分区配置。右键单击 Windows SIM 中的“Windows 映像”窗格，然后选择适当的配置阶段，将第二个 CreatePartition 和第二个 ModifyPartition 组件添加到答案文件。此操作会将 CreatePartition 和 ModifyPartition 组件的第二个实例添加到答案文件。</p><p>       3、添加的所有设置都必须显示在 Windows SIM 的“答案文件”窗格中。在“设置”下，选择相应设置，并按照下表中指定的那样，在右侧列中输入适当的值。</p><p> </p><table border="1" cellpadding="1" cellspacing="1" style="width: 100%;"><tbody><tr><td><span style="font-size: small;"> 配置阶段</span></td><td><span style="font-size: small;"> 组件</span></td><td><span style="font-size: small;"> Value</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-International-Core-WinPE</span></td><td><span style="font-size: small;"> InputLocale = <span style="color: #ff0000;">zh-CN </span>&lt;中文-中国&gt;<br/>
                        en-US &lt;英文-美国&gt;<br/>
 SystemLocale = <span style="color: #ff0000;">zh-CN </span>&lt;系统区域设置&gt;<br/>
 UILanguage = <span style="color: #ff0000;">zh-CN </span>&lt;UI 语言&gt;<br/>
 UserLocale = <span style="color: #ff0000;">zh-CN </span>&lt;用户区域设置&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-International-Core-WinPE<br/>
 \SetupUILanguage</span></td><td><span style="font-size: small;"> UILanguage = <span style="color: #ff0000;">zh-CN </span>&lt;UI 语言&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\DiskConfiguration</span></td><td><span style="font-size: small;"> WillShowUI = <span style="color: #ff0000;">OnError</span> &lt;有错误才显示&gt;<br/>
                         Always &lt;总是显示&gt;<br/>
                         Never &lt;从来不显示&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\DiskConfiguration\Disk</span></td><td><span style="font-size: small;"> DiskID = <span style="color: #ff0000;">0</span> &lt;磁盘号&gt;<br/>
 WillWipeDisk = <span style="color: #ff0000;">true</span> &lt;是清空磁盘&gt;<br/>
                            flase &lt;不清空磁盘&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\DiskConfiguration\Disk<br/>
 \CreatePartitions\CreatePartition</span></td><td><span style="font-size: small;"> Extend =  <span style="color: #ff0000;">flase</span> &lt;非扩展分区&gt;<br/>
                  true  &lt;是扩展分区&gt;<br/>
 Order = <span style="color: #ff0000;">1</span> &lt;分区号&gt;<br/>
 Size = <span style="color: #ff0000;">200</span> &lt;分区大小M&gt;<br/>
 Type = <span style="color: #ff0000;">Primary</span><strong> </strong>&lt;主分区&gt;<br/>
             Extended &lt;扩展分区&gt;<br/>
             EFI &lt;EFI分区&gt;<br/>
             Logical &lt;逻辑分区&gt;<br/>
             MSR &lt;microsoft保留分区&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\DiskConfiguration\Disk<br/>
 \CreatePartitions\CreatePartition</span></td><td><span style="font-size: small;"> Extend =  <span style="color: #ff0000;">flase</span> &lt;非扩展分区&gt;<br/>
                  true  &lt;是扩展分区&gt;<br/>
 Order = <span style="color: #ff0000;">2</span> &lt;分区号&gt;<br/>
 Size = <span style="color: #ff0000;">40963</span> &lt;分区大小M&gt;<br/>
 Type = <span style="color: #ff0000;">Primary</span> &lt;主分区&gt;<br/>
             Extended &lt;扩展分区&gt;<br/>
             EFI &lt;EFI分区&gt;<br/>
             Logical &lt;逻辑分区&gt;<br/>
             MSR &lt;microsoft保留分区&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\DiskConfiguration\Disk<br/>
 \ModifyPartitions\ModifyPartition</span></td><td><span style="font-size: small;"> Active = <span style="color: #ff0000;">true</span> &lt;活动分区&gt;<br/>
               flase &lt;非活动分区&gt;<br/>
 Format = <span style="color: #ff0000;">NTFS</span> &lt;文件系统格式为NTFS&gt;<br/>
                FAT32 &lt;文件系统格式为FAT32&gt;<br/>
 Label = <span style="color: #ff0000;"><em>system</em></span> &lt;驱动器卷标&gt;<br/>
 Order = <span style="color: #ff0000;">1</span> &lt;驱动器号&gt;<br/>
 PartitionID = <span style="color: #ff0000;">1</span> &lt;分区号&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\DiskConfiguration\Disk<br/>
 \ModifyPartitions\ModifyPartition</span></td><td><span style="font-size: small;"> Format = <span style="color: #ff0000;">NTFS</span> &lt;文件系统格式为NTFS&gt;<br/>
                 FAT32 &lt;文件系统格式为FAT32&gt;<br/>
 Label = <em><span style="color: #ff0000;">windows</span></em> &lt;驱动器卷标&gt;<br/>
 Order = <span style="color: #ff0000;">2</span> &lt;驱动器号&gt;<br/>
 PartitionID = <span style="color: #ff0000;">2</span> &lt;分区号&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\ImageInstall\OSImage</span></td><td><span style="font-size: small;"> InstallToAvailablePartition = <span style="color: #ff0000;">false </span>&lt;不安装到可用分区&gt;<br/>
                                                true &lt;安装到可用分区&gt;<br/>
 WillShowUI = <span style="color: #ff0000;">OnError</span> &lt;有错误才显示&gt;<br/>
                        Always &lt;总是显示&gt;<br/>
                        Never &lt;从来不显示&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\ImageInstall\OSImage<br/>
 \InstallTo</span></td><td><span style="font-size: small;"> DiskID = <span style="color: #ff0000;">0</span> &lt;磁盘号&gt;<br/>
 PartitionID = <span style="color: #ff0000;">2</span> &lt;分区号&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\UserData</span></td><td><span style="font-size: small;"> AcceptEula = <span style="color: #ff0000;">true</span> &lt;接受许可协议&gt;<br/>
                        flase &lt;不接受许可协议&gt;</span></td></tr><tr><td><span style="font-size: small;"> 1 WindowsPE</span></td><td><span style="font-size: small;"> Microsoft-Windows-Setup\UserData\ProductKey</span></td><td><span style="font-size: small;"> Key = <span style="color: #ff0000;"><em>xxxxx-xxxxx-xxxxx-xxxxx-xxxxx </em></span>&lt;产品密钥&gt;<br/>
 WillShowUI = <span style="color: #ff0000;">OnError </span>&lt;有错误才显示&gt;<br/>
                        Always &lt;总是显示&gt;<br/>
                        Never &lt;从来不显示&gt; </span></td></tr><tr><td><span style="font-size: small;"> 4 Specialize</span></td><td><span style="font-size: small;"> 可选：Microsoft-Windows-IE-InternetExplorer</span></td><td><span style="font-size: small;"> Home_Page = <a href="http://www.hao123.com/" rel="nofollow"><em><span style="color: #ff0000;">http://www.hao123.com/</span></em></a> &lt;IE主页&gt;</span></td></tr><tr><td><span style="font-size: small;"> 7 oobeSystem</span></td><td><span style="font-size: small;"> Microsoft-Windows-Deployment\Reseal</span></td><td><span style="font-size: small;"> ForceShutdownNow = <span style="color: #ff0000;">false</span> &lt;现在不强制关机&gt;<br/>
 Mode = <span style="color: #ff0000;">Audit</span> &lt;审核&gt;<br/>
              OOBE &lt;全新体验&gt;</span></td></tr><tr><td><span style="font-size: small;"> 7 oobeSystem</span></td><td><span style="font-size: small;"> Microsoft-Windows-Shell-Setup\OOBE</span></td><td><span style="font-size: small;"> HideEULAPage = <span style="color: #ff0000;">true</span> &lt;隐藏许可协议页&gt;<br/>
                               flase &lt;显示许可协议页&gt;<br/>
 ProtectYourPC = <span style="color: #ff0000;">3</span> &lt;不自动获取补丁&gt;<br/>
                              2 &lt;自动获取重要补丁&gt;<br/>
                              1 &lt;自动获取所有补丁&gt;<br/>
 SkipUserOOBE = <span style="color: #ff0000;">true</span> &lt;跳过用户全新体验&gt;<br/>
                               flase &lt;不跳过用户全新体验&gt;</span></td></tr></tbody></table><p> </p><p>       </p><p>FROM：http://zhanqiguang.blog.163.com/blog/static/4650796220134610693/</p><p>====================================================================</p><p> </p><p>创建答案文件的步骤</p><ol><li>在技术人员计算机上插入 Windows 7 产品 DVD或用虚拟光驱加载Windows 7 产品iso镜像文件。</li><li>导航到 DVD-ROM 驱动器或虚拟光驱上的 \Sources 目录，并将 install.wim 文件复制到计算机上的某个位置。</li><li>若要打开 Windows SIM（<strong><span style="text-decoration: underline;"><a href="http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=696dd665-9f76-4177-a811-39c26d3b3b34" target="_blank">下载地址</a></span></strong>），请依次单击<strong>“开始”</strong>、<strong>“所有程序”</strong>、<strong>Microsoft Windows AIK</strong>，然后单击<strong>“Windows 系统映像管理器”</strong>。</li><li>在 Windows SIM 的<strong>“文件”</strong>菜单上，单击<strong>“选择 Windows 映像”</strong>。</li><li>在<strong>“选择 Windows 映像”</strong>对话框中，导航到步骤 1 中保存 Install.wim 的位置，然后单击<strong>“打开”</strong>。<br/>
系统将提示您选择映像。选择要安装的 Windows 映像，然后单击<strong>“确定”</strong>。<br/>
系统将提示您创建编录文件。单击<strong>“是”</strong>生成文件。<br/>
如果<strong>“用户帐户控制”</strong>窗口提示您批准此程序，则可以选择允许此程序或取消安装。</li><li>在<strong>“文件”</strong>菜单上，单击<strong>“新建答案文件”</strong>。一个空答案文件会显示在<strong>“答案文件”</strong>窗格中。</li></ol><p>添加和配置 Windows 设置</p><p>首先我来介绍一下windows映像管理器的界面</p><p>1、左下角的【Windows 映像】，这里可以选择我们要进行设定的模块<br/>
中间靠上部分的【应答文件】，这里我们会以树状结构预览到我们的各项设定，包括如下内容：<br/>
（1）【windowsPE】，众所周知Windows7在安装前会启动一个WINPE环境以执行系统安装，这个设定就是关于这个PE的<br/>
（2）【offlineServicing】，这部分设定是关于离线服务的，一般用不到<br/>
（ 3）【generalize】，这部分设定很重要，关于一般系统部署过程的<br/>
（4）【sepcialize】，这部分设定很重要，关于特殊系统部署过程的( _* U( J. ]4 v3 A( }   R7 ?+ B# G<br/>
（5）【auditSystem】和【auditUser】，这两部分是关于系统审核的，一般用不到<br/>
（6）【oobeSystem】，这部分设定很重要，关于OOBE过程的<br/>
   右侧的【属性】，这里用于设定每个选项的具体属性</p><p>我们下面的操作遵循这样一种过程，在【Windows 映像】中选择要设定的模块，将选中的模块传送到【应答文件】中适当的实机，后在【属性】中对刚刚传送来的实机进行详细设定</p><p> </p><p>在此步骤中，将定义基本磁盘配置和“欢迎使用 Windows”设置。</p><ol><li>在 Windows SIM 的<strong>“Windows 映像”</strong>窗格中，展开<strong>“组件”</strong>节点以显示可用的设置。</li><li>在展开的组件列表中，右键单击组件并选择适当的配置阶段，将下表中的组件添加到答案文件。此操作会在指定配置阶段或 Windows 安装阶段将组件添加到答案文件中。通过添加可选组件，可以在步骤 2（构建参考安装）中更加方便地测试安装。</li></ol><p>注意：</p><p>展开 Windows 映像窗格中的组件列表，直到看见下表中的最低层子节点。例如，展开 Microsoft-Windows-Setup 可查看 DiskConfiguration 节点。展开 DiskConfiguration 节点，直到看见 Disk 节点。继续展开 Microsoft-Windows-Setup 下的树，直到看见下表中列出的 CreatePartition 节点。将此 CreatePartition 节点添加到答案文件。此快捷方式可一步将该设置和所有父设置添加到答案文件。</p><p>1.设置语言(Intemational-Core)</p><p>　　由于Windows安装程序改用Windows PE程序导入，所以设置语言亦分为两部分，下面将先介绍Windows PE的核心语言设置即“Microsoft-Windows-International-Core-WinPE”。然后才是windows7的语言设 置，即“Microsoft-Windows-International-Core”。</p><p>　　(1)在windows系统映像管理器程序操作界面左边的“Windows 映像”窗口中，点选“Microsoft-Windows-International-Core-WinPE”元件，单击鼠标右键并选择“添加设置以传 送 1 windowsPe（1)”一项(如图).</p><p>      (2)在windows系统映像管理器程序界面中间的“应答文件”窗口的“1 WindowsPE”一项下，选择“Microsoft-Windows-International-Core-WinPE”子项，将修改 Windows PE安装环境中的各项设置。</p><p>      (3)在windows系统映像管理器程序界面的右方窗口中，“1 windows PE”项目对应的设置参数包括</p><p> </p><p>　　笔者测试时采用简体中文旗舰版windows7系统光盘进行安装，故设置所有的输入语言均为“zh-CN”(简体中文);若用户需用英文显示， 可根据以下说明将个别项目更改为“en-US”，而繁体中文则输入“zh-HK”。其中，“InputLocale”一项用来设置输入语 言;“LayerDriver”一项指键盘的种类，除了韩国和日本，都应选择“1”;“SystemLocale”一项设置运行非Unicode程序时， 系统默认使用的预言;“UILanguage”一项设置用户界面的语言;“UILanguageFallback”与“UILanguage”项目相关， 当“UILanguase”选用小地区时，若程序没有该种语言，则会跳至“UILanguageFallback”选项;“UserLocale”项目是 指日期、时间、数字等格式。</p><p>    (4)然后，在windows系统映像管理器程序界面中间的“应答文件”窗口中，依次点选“1 Windows PE”→“Microsoft-Windows-International-Core WinPE”→“SetupUILanguage”子项。“SetupUILanguage”指的是在安装windows7的整个过程中，界面所显示的语 言。接着，在windows系统映像管理器程序界面右方的窗口中进行参数设置。</p><p>　　具体而言，“UILanguage”一项同样根据需要输入，设置为“zh-CN”的话将使用中文界面;“WillShowUI”一项指的是安装 前是否显示对话框询问用户有关安装界面的语言设置。有三个参数可供选择：“OnError”指有错误时显示对话框;“Never”指任何情况下永不显 示;“Always”是指每次都显示。由于我们希望达成自动安装的目的，因此选用“OnError”可减少用户需要手工输入的机会。</p><p>(5)在windows系统映像管理器程序操作界面的“Windows 映像”窗口中，点选“Microsoft-Windows-International-Core”元件，单击鼠标右键并选择“添加设置以传送 7 oobeSystem（7）”一项。</p><p>(6)在windows系统映像管理器程序界面中间的“应答文件”窗口内，依次点选“7oobeSystem”→“Microsoft- Windows-International-Core”子项。其具体设置参数与前面的“Microsoft-Windows- International-Core-WinPE”的原理相同，不过这里的设置参数将套用到安装后的windows7使用环境。</p><p> </p><p>2.WindowsPE安装设置</p><p>  (1)在windows系统映像管理器程序界面的“Windows 映像”窗口中点选“Microsoft-Windows-Setup”元件，并单击鼠标右键选择“添加设置以传送 1 WindowsPE（1）”一项。</p><p>  (2)在windows系统映像管理器程序界面中部的“应答文件”窗口的“1 windowsPE”项目下，选择“Microsoft-Windows-Setup”子项。</p><p> (3)然后在windows系统映像管理器程序界面右方的设置窗口中，</p><p>最重要的项目是“UseConfigurationSet”，需设置为参数“Ture”，否则安装时将停下来寻找相关驱动程序或安装程 序;“Restart”一项是指安装完成后Windows PE会关机还是重新启动继续运行。建议选“Restat”;“LogPath”一项设置安装记录文件的存放位置，可不输 入;“EnableFirewall”(防火墙)及“EnableNetwork”(网络)两项应选择“True”，会分别启动防火墙和网络，但这里针对 的只是安装过程中的Windows PE使用环境，而非安装后的windows7运行环境。</p><p>  (4)在windows系统映像管理器界面中间的“应答文件”窗口中，依次点选“1 windows PE”→“Microsoft-Windows-Setup”→“UserData”子项。</p><p>　(5)然后在windows系统映像管理器界面右方的参数设置窗口中，</p><p>“AcceptEula”一项选择“True”，可直接跳过用户者授权协议，否则安装时会显示对话框，询问是否接受Windows7的使用者授权协议;“Organization”和“FullName”两项分别用来设置Windows7的组织资料和用户资料。</p><p>   (6)在windows系统映像管理器界面中间的“应答文件”窗口中，依次点选“1 windows PE”→“Microsoft-Windows-Setup”→“UserData→“ProductKey”子项目。</p><p>  (7)然后，在windows系统映像管理器界面右方的参数设置窗口中，</p><p>　　“Key”一项所指的是产品序列号，即windows7操作系统的产品包装盒上的五组五位字母，输入时请包括中间的“-”符号。如果你不想在应 答文件中输入产品序列号，则以后安装windows7时也会要求用户输入;“WillShowUI”一项选择“OnError”，使应答文件运行时除非出 现问题，否则不会显示要求用户输入的界面。</p><p>3.安装磁盘设置</p><p> (1)在windows系统映像管理器程序界面左边的“Windows 映像”窗口依次点选“Microsoft-Windows-Setup”→“DiskConfiguration”→“Disk”元件，单击鼠标右键选择 “添加设置以传送 1 windowsPE（1）”一项。</p><p> (2)在windows系统映像管理器程序界面中间的“应答文件”窗口中，依次点选“1 WindowsPE”→“Microsoft-Windows-Setup”→“DiskConfiguration”子项。 “DiskConfiguration”所指的是安装系统的硬盘分区并包括格式化方式。</p><p> (3)在windows系统映像管理器程序界面右方的窗口中设置参数时，</p><p>建议第一次使用时将“WillShow UI”一项选用“Always”参数，这里也是Vista安装过程中唯一会弹出对话框的部分。本文的后面部分有更详细的设置教学，日后若用户熟悉此项设置，可根据需要再作修改。</p><p>  (4)在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点选“DiskConfiguration”→“Disk”子项。</p><p>(5)然后，在windows系统映像管理器程序界面右方的设置窗口中，</p><p>　　“DiskID”一项代表物理硬盘的编号，第一个硬盘是从编号“0”开始的;“WillWipeDisk”一项代表进行安装操作前预先完全清除 硬盘，包括以前在硬盘上建立的所有磁盘分区。它与前面的“DiskConfiguration”子项目相同，建议用户使用“False”参数，以免错误清 空所有资料。</p><p>4.跳过上网验证</p><p>　　(1)在windows系统映像管理器程序界面左边的“Windows 镜像”窗口中，点选“Microsoft-Windows-Security- Licensing-SLC-UX”元件，并单击鼠标右键选择“Add Setting to Pass 4 specialize”项目。</p><p>      (2)在windows系统映像管理器程序界面中部的“应答文件”窗口内，依次点击“4 specialize”→“Microsoft-Windows-Security-Licensing-SLC-UX”子项。</p><p>　　(3)然后在windows系统映像管理器程序界面右方的设置窗口中，</p><p>“SkipAutoActivation”一项的预设值为“false”，表示安装windows7系统时会上网进行验证激活(Activation)，为了让安装更顺利快捷，应修改“SkipAutoActivation”的设置为“True”参数。</p><p>5.windows7系统设置</p><p>　　(1)在windows系统映像管理器程序界面左边的“Windows 镜像”窗口中选择“Microsoft-Windows-Shell-Setup”元件，单击鼠标右键并选择“Add Setting to Pass 7 oobeSystem”一项。</p><p>       (2)在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup”子项。</p><p>　　(3)接下来在windows系统映像管理器程序界面右方的“属性”窗口中，设置安装后进入Windows7的参数。</p><p>其中，“BluetoothTaskbarlconEnabled”一项，可设置蓝芽管理工具是否在任务栏显 示;“DisableAutoDaylightTimeSet”一项指的是关闭夏时制时间;“DoNotCleanTaskBar”一项是指不隐藏非使用 状态中的图标;“RegisteredOrganization”和“RegisteredOwner”两项分别是注册的组织和用户名字，每项最多可输入 256个字节;“ShowWindowsLive”一项，会在每次开机时显示欢迎画面，故应修改成“False”参数;“StartPanelOff”一 项会关闭开始菜单，也应改成“False”参数;最后，“TimeZone”一项用来设置时区，中国用户应输入“China Standard Time”，即采用我们熟知的“(GMT+08:00) 北京、重庆、香港特别行政区、乌鲁木齐”时区。</p><p>       (4)在windows系统映像管理器程序界面中间的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup”→“OOBE”子项目。</p><p>　　(5)然后，在windows系统映像管理器程序界面右方的设置窗口中进行参数设置。</p><p>其中，“HideEULAPage”一项表示隐藏使用者授权协议画面，应改为“True”参数;<strong>HideWirelessSetupInOOBE</strong>: 设定为true,即跳过OOBE中的无线设定部分;设定为false,则不跳过 “NetworkLocation”一项用来设置网络类型，用户可根据个人的应用环境选择“Home”、“Work”与“Other”参 数;“ProtectYourPC”一项设置电脑自动保护级别，有3个数值可供选择：“1.对应自动获取所有补丁、2.对应自动获取重要补丁、3.对应不 自动升级三个选项<br/>
，建议使用“1”;“SkipMachineOOBE”与“SkipUserOOBE”两个项目，用来停止启动的欢迎画面，建议使用“True”参数。</p><p>       (6)在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup”→“VisualEffects”。</p><p>　　(7)然后在windows系统映像管理器程序界面右方的设置窗口中进行参数调整。</p><p>Font Smoothing项目能够改变windows7系统显示字体的圆滑效果，共有4种参数：“Standard”表示系统根据硬件性能自动设置;“On”表 示强制打开“Font Smoothing”功能，相反“Off”表示强制关闭;“ClearType”则设置为最清楚的ClearType显示模式，建议用户使用最后一项。</p><p>       (8)在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup”→“Display”子项。</p><p>　　(9)然后在windows系统映像管理器程序界面右方的参数设置窗口中，可调整显示设置。</p><p>其中，“ColorDepth”一项代表色深，通常设为“32”(32位色深);“DPI”一项是点 距;“HorizontalResolution”与“VerticalResolution”两项分别为垂直和水平分辨率;“RefreshRate” 一项设置显示器的刷新频率。</p><p>6.用户帐号及自动登录设置</p><p>　　(1)在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点击“7 oobdSystem”→“Microsoft-Windows-Shell-Setup”→“AutoLogon”子项。</p><p>　　(2)然后在windows系统映像管理器程序界面右方的窗口进行参数设置，</p><p>此部分共有四个选项。“Domain”一项指登录的区域，家庭用户可不输入资料;“Enabled”一项指打开自动登录(AutoLogo)机制， 当然应设为“True”参数;“LogonCount”项目顾名思义是登录帐户使用次数，从“1”开始。“Username”一项代表默认帐户名，这个帐 户将属于系统管理员组(Administrator)，用户名称只能用英文字母组成。</p><p>      (3)在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点击“7 oobdSystem”→“Microsoft-Windows-Shell-Setup”→“AutoLogon”→“Password”子项。</p><p>　　(4)然后在windows系统映像管理器程序界面右方的参数设置窗口中进行设置。</p><p>用户可在“Value”项目上单击鼠标右键，并在随后弹出的快捷功能菜单中选择“写入空字符串（s）”一项，即不设密码，让界面自动登录。</p><p>       (5)在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup” →“UserAccounts”→“AdministratorPassword”子项。“AdministratorPassword”项目代表系统管 理员的密码。</p><p>        (6)然后在windows系统映像管理器程序界面右方窗口进行参数设置。</p><p>用户可在“Value”项目上单击鼠标右键，并选择“写入空字符串”一项，日后再设置密码。</p><p>      (7)同样，在windows系统映像管理器程序界面中部的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup” →“UserAccounts”→“LocalAccounts”子项目。“LocalAccounts”指的是除了系统管理员以外的其他帐号。</p><p>7.验证和保存文件</p><p>　　完成上述所有设置后，可利用WAIK软件内置的验证工具先检测一次，查看基本的资料是否设置错误或遗漏，然后才保存成Windows唯一能够识别的“Autounattend.xml”文件。</p><p>　　验证方法为：</p><p>　　(1)在windows系统映像管理器程序界面的菜单栏上依次点击“工具”→“验证应答文件”，开始进行验证。</p><p>如果操作界面右下角的“消息”窗口中出现红色“X”符号就表示有问题，黄色惊叹号则无须理会。</p><p>          (2)完成验证后在windows系统映像管理器程序菜单栏上点击“文件” →“保存应答文件”，文件名称必需保存成“Autounattend.xml”，这样Windows Vista的安装程序才会自动读取。</p><p>          (3)保存“Autounattend.xml”文件的方法有两种。如果是一张完整的自动安装光盘，应将“Autounattend.xml”文件放置于 光盘内的根目录下。另一种方法则是方便IT测试人员而设计的，Windows7安装程序会自动检测周边的存储设备，包括闪存盘、移动硬盘，前提同样是要放 在各种存储设备的根目录下，以便随时修改文件。</p><p>     下面补充说明一下.怎样才能让安装过程跳过建立用户账号而是以admin账号直接登录的方法</p><p>在windows系统映像管理器程序操作界面的“Windows 映像”窗口中，点选“Microsoft-Windows-Shell-Setup”元件，单击鼠标右键并选择“添加设置以传送 7 oobeSystem（7）”一项。</p><p>在windows系统映像管理器程序界面中间的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup”→“OOBE”子项目。将OOBE模块的 SkipMachineOOBE设置为“true”   v(</p><p>SkipMachineOOBE一旦被设置为“true”，OOBE过程就会被跳过，则OOBE部分的其他设定就没有太多意义了，所以我取消OOBE的其他设定。<br/>
保存，系统安装时使用这个xml配置文件，就会跳过系统OOBE过程。<br/><br/>
需要注意的是，如果没有自动激活ADMIN，则不要使用此功能。不然我们就没有可登录的用户了.没有用户可用，也无法创建新用户，那么这个系统就无法被登录和使用，则这个系统就成了名副其实的废物……! .</p><p>那么怎么激活admin账户呢.大家接着看.</p><p>在windows系统映像管理器程序界面中间的“应答文件”窗口中，依次点选“7 oobeSystem”→“Microsoft-Windows-Shell-Setup”→“autologon”子项目。将autologon模块的 username设置为“administrator”</p><p>如果想修改ie的主页.可以照下面的方法.</p><p>在windows系统映像管理器程序操作界面的“Windows 映像”窗口中，点选“Microsoft-Windows-IE-Internetexplorer”元件，单击鼠标右键并选择“添加设置以传送 4 specialize（4）”一项。</p><p>在windows系统映像管理器程序界面中间的“应答文件”窗口中，依次点选“4 specialize”→“Microsoft-Windows--IE-Internetexplore”项目。将右面属性对话框里的home_Page选项添加你想添加的主页.</p><p> </p><p>FROM：http://hi.baidu.com/lilejiuxiang/item/620a533d59d4eb0cceb9febd</p><br/><div style="color:gray"><small>来源： &lt;<a href="http://www.cnblogs.com/dreamer-fish/p/3468388.html">http://www.cnblogs.com/dreamer-fish/p/3468388.html</a><small>&gt;</small></small></div><small><small> </small></small></div></span>
</div></body></html> 